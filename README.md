The code is a mess. I know
